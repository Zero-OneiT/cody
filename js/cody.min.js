!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.Cody=e()}(this,function(){function t(t){return t.charAt(0).toUpperCase()+t.slice(1)}function e(t){return t.split(",").map(function(t){return t.trim()})}function n(t,e){t.push.apply(t,e)}function i(t,e){for(var n in e)t[n]=V.arr(e[n])?e[n].slice(0):e[n];return t}function r(t,e){t||(t={});for(var n=1;n<arguments.length;n++)i(t,arguments[n]);return t}function s(t,e,n,i){var r=document.createElement(t);return V.str(e)&&(r.className=e),V.str(n)&&(r.id=n),V.und(i)||i.appendChild(r),r}function a(t){return{count:0,async:!1,add:function(){this.count++,this.async=!0},check:function(){0==--this.count&&t()}}}function o(t,e,n){n&&n.add();var i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&(e(200===i.status?i.responseText:""),n&&n.check())},i.send()}function c(t,e){return e||(e=document),e.querySelector(t)}function u(t,e){t.classList.add(e)}function l(t,e){t.classList.remove(e)}function d(t){return t.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()})}function f(t){return t.dataset||[].slice.call(t.attributes).reduce(function(t,e){return/^data-/.test(e.name)&&(t[d(e.name.substr(5))]=e.value),t},{})}function h(t){var e,n={};for(var i in t)e=t[i],n[i]=V.num(e)?parseFloat(e):e;return n}function b(t){for(var e,n=r({},j,t),i=document.querySelectorAll(n.target),s=0;s<i.length;s++)e=i[s],p(e,r(n,h(f(e))))}function p(t,n){function i(){var e=H("cody-container",t,r(n,{height:f+"px"})),i=e.contentWindow.document.body;l&&u(i,"result-always-visible");var a=s("div",0,"tabs",i),o=s("div",0,"boxes",i),c=n.tabsVisible?n.tabsHeight+"px":0,h=n.boxesHeight+"px";a.style.height=c,a.style.lineHeight=c,o.style.height=h;var b=r({},n,A,{tabs:a,boxes:o,height:d+"px"});for(var p in A)~w.indexOf(p)&&y(p,A[p],b);var g=e.contentWindow;g.Prism&&g.Prism.highlightAll(),v(n)}var l=n.resultAlwaysVisible,d=V.num(l)?l:n.boxesHeight,f=n.boxesHeight;n.tabsVisible&&n.tabsSpace&&(f+=n.tabsHeight),l&&(f+=d),t.style.height=f+"px",g(t,n);for(var h,b,p,m,x=["html","css","js","result"],w=e(n.tabs),A={},j=a(i),C=0;C<x.length;C++)h=x[C],b=c("."+h,t),m={el:b},b?(p=b.getAttribute("data-code"),p?!function(t){o((V.sta(p,"http")?"":n.baseUrl)+p,function(e){t.code=e},j)}(m):m.code=b.value||""):n.pen&&"result"!==h?!function(t){o(n.pen+"."+h,function(e){t.code=t.el=e},j)}(m):m.code="",A[h]=m;j.async||i()}function g(t,e){if(e.loading){t.insertAdjacentHTML("afterbegin",e.loading);var n=c(".cody-loading",t);u(n,"cody-loading-visible"),e.loading=n}}function v(t){var e=t.loading;e&&l(e,"cody-loading-visible")}function m(t,e,n,i){var r=document.createTextNode(t),a=i.lineNumbers?"highlight line-numbers":"highlight",o=s("pre",a,0,e),c=s("code","language-"+n,0,o);c.appendChild(r)}function y(e,n,i){var r=e===i.selected,a="result"===e,o=i.resultAlwaysVisible;if(r||i.tabsVisible||a||o){var c=s("div","box",e,i.boxes);if(i.tabsVisible&&(!a||!o)){var l=s("a","tab","tab-"+e,i.tabs);l.innerHTML=i[e+"Title"]||(a?t(e):e.toUpperCase()),l.href="#"+e}a?(c.style.height=i.height,H("cody-result",c,i)):m(n.code,c,e,i),r&&(i.tabsVisible&&l&&u(l,"tab-active"),u(c,"box-active")),i.tabsVisible&&l&&x(l,c,i)}}function x(t,e,n){t.addEventListener("click",function(i){i.preventDefault(),l(c(".tab-active",n.tabs),"tab-active"),l(c(".box-active",n.boxes),"box-active"),u(t,"tab-active"),u(e,"box-active")})}function w(t,e,n){switch(t){case"html":return e;case"css":return V.ast(e)?'<link rel="stylesheet" href="'+(V.sta(e,"http")?"":n)+e+'">':"<style>"+e+"</style>";case"js":return V.ast(e)?'<script src="'+(V.sta(e,"http")?"":n)+e+'"></script>':"<script>"+e+"</script>";default:return""}}function A(t,i){var r,s,a,o,c="";if(r=i[t],o=V.arr(r)?r:V.und(r)?[]:[r.el],a=i[t+"Assets"]){var u=[];n(u,e(a)),n(u,o),o=u}for(;o.length;)s=o.shift(),V.str(s)?c+=w(t,s,i.baseUrl):s&&(o=[],a=s.getAttribute("data-assets"),a&&n(o,e(a)),r.code&&o.push(r.code));return c}function H(t,e,n){var i=A("html",n),r=A("css",n),a=A("js",n),o="<!DOCTYPE html><html><head>"+r+"</head><body>"+i+a+"</body></html>",c=s("iframe",t,0,e);return c.width="100%",c.height=n.height,c.src="about:blank",c.style.overflow="hidden",c.setAttribute("frameborder","0"),c.contentWindow.document.open("text/html","replace"),c.contentWindow.document.write(o),c.contentWindow.document.close(),c}var V={arr:function(t){return Array.isArray(t)},str:function(t){return"string"==typeof t},und:function(t){return"undefined"==typeof t},num:function(t){return!isNaN(parseFloat(t))},sta:function(t,e){return t.substr(0,e.length)===e},end:function(t,e){return t.substr(-e.length)===e},ast:function(t){return V.str(t)&&(V.end(t,".html")||V.end(t,".css")||V.end(t,".js"))}},j={target:".cody",boxesHeight:145,tabsHeight:35,tabsVisible:!0,tabsSpace:!0,tabs:"html, css, js, result",selected:"result",lineNumbers:!1,resultAlwaysVisible:!1,loading:'<div class="cody-loading"><div class="spinner"></div></div>',baseUrl:""};return{init:b}});